angular.module("angularDob",[]),angular.module("angularDob").factory("CommonDob",[function(){var e={};return e.parseDob=function(e){var t,r,n,a;return e=e||"",e=e.replace(/\s/g,""),a=e.split("/",3),t=a[1],r=a[0],n=a[2],t=parseInt(t,10),r=parseInt(r,10),n=parseInt(n,10),{day:t,month:r,year:n}},e}]),angular.module("angularDob").factory("_FormatDob",["CommonDob","$filter",function(e,t){var r=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")?!0:!("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)&&"function"==typeof t.createRange?!t.createRange().text:!0)};_restrictDob=function(e){var t,n,a;return t=angular.element(e.currentTarget),n=String.fromCharCode(e.which),!/^\d+$/.test(n)&&!e.meta&&e.keyCode>=46?void e.preventDefault():r(t)?void 0:(a=t.val()+n,a=a.replace(/\D/g,""),a.length>8?void e.preventDefault():void 0)},_formatDob=function(e){var t,r,n;return r=String.fromCharCode(e.which),!/^\d+$/.test(r)&&!e.meta&&e.keyCode>=46?void e.preventDefault():(t=angular.element(e.currentTarget),n=t.val()+r,original=t.val(),/^\d$/.test(n)&&"0"!==n&&"1"!==n?(e.preventDefault(),t.val("0"+n+" / ")):/^\d\d$/.test(n)?(e.preventDefault(),t.val(""+n+" / ")):/^\d\d\s\/\s\d$/.test(n)&&"0"!==r&&"1"!==r&&"2"!==r&&"3"!==r?(e.preventDefault(),t.val(""+original+"0"+r+" / ")):/^\d\d\s\/\s\d\d$/.test(n)?(e.preventDefault(),t.val(""+n+" / ")):void 0)},_formatForwardDob=function(e){var t,r,n;return r=String.fromCharCode(e.which),!/^\d+$/.test(r)&&!e.meta&&e.keyCode>=46?void 0:(t=angular.element(e.currentTarget),n=t.val(),/^\d\d$/.test(n)?t.val(""+n+" / "):/^\d\d\s\/\s\d\d$/.test(n)?t.val(""+n+" / "):void 0)},_formatForwardSlash=function(e){var t,r,n;return r=String.fromCharCode(e.which),"/"===r?(t=angular.element(e.currentTarget),n=t.val(),/^\d$/.test(n)&&"0"!==n?t.val("0"+n+" / "):/^\d\d\s\/\s\d$/.test(n)?t.val(""+n+" / "):void 0):void 0},_formatBackDob=function(e){var t,r;if(!e.meta&&(t=angular.element(e.currentTarget),r=t.val(),8===e.which&&(null==t.prop("selectionStart")||t.prop("selectionStart")===r.length)))return/\d(\s|\/)+$/.test(r)?(e.preventDefault(),t.val(r.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(r)?(e.preventDefault(),t.val(r.replace(/\s\/\s?\d?$/,""))):void 0};var n=function(r){if(null!=r){var n=e.parseDob(r),a=new Date(n.year,n.month-1,n.day);return t("date")(a,"MM/dd/yyyy")}return null},a=function(r){if(null!=r){var n=e.parseDob(r),a=new Date(n.year,n.month-1,n.day);return t("date")(a,"MM / dd / yyyy")}return null};return function(e,t){e.bind("keypress",_restrictDob),e.bind("keypress",_formatDob),e.bind("keypress",_formatForwardSlash),e.bind("keypress",_formatForwardDob),e.bind("keydown",_formatBackDob),t.$parsers.push(n),t.$formatters.push(a)}}]).directive("dobFormat",["$window","_FormatDob",function(e,t){return{restrict:"A",require:"ngModel",link:function(e,r,n,a){t(r,a)}}}]),angular.module("angularDob").factory("_ValidateDob",["CommonDob",function(e){var t=function(t){if(null==t||0==t.length)return!0;obj=e.parseDob(t),day=obj.day,month=obj.month,year=obj.year;var r,n;return month&&year&&day&&/^\d+$/.test(day)&&/^\d+$/.test(month)&&/^\d+$/.test(year)&&parseInt(month,10)<=12?(n=new Date(year,month,day),void 0,void 0,void 0,n.getFullYear()!=year||n.getMonth()!=month||n.getDate()!=day?!1:(r=new Date,n.setMonth(n.getMonth()-1),n.setMonth(n.getMonth()+1,1),void 0,r>n)):!1};return function(e,r,n,a){return t(e)}}]).directive("dobValidate",["$window","_ValidateDob",function(e,t){return{restrict:"A",require:"ngModel",link:function(e,r,n,a){var o=n.dobValidate,l=function(r){var l=t(r,a,e,n);return a.$setValidity(o,l),l?r:void 0};a.$formatters.push(l),a.$parsers.push(l)}}}]);